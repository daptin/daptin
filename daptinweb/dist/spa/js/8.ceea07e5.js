(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{c518:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"q-pa-md q-gutter-sm"},[a("q-breadcrumbs",{scopedSlots:t._u([{key:"separator",fn:function(){return[a("q-icon",{attrs:{size:"1.2em",name:"arrow_forward",color:"black"}})]},proxy:!0}])},[a("q-breadcrumbs-el",{attrs:{label:"Integrations",icon:"fas fa-bolt"}}),a("q-breadcrumbs-el",{attrs:{label:"Actions",icon:"fas fa-wrench"}})],1)],1),a("q-separator"),a("div",{staticClass:"row q-pa-md q-gutter-sm"},[a("div",{staticClass:"col-12"},[a("q-input",{attrs:{"clear-icon":"fas fa-times",label:"search"},model:{value:t.actionFilter,callback:function(e){t.actionFilter=e},expression:"actionFilter"}})],1),a("div",{staticClass:"col-12"},[a("q-markup-table",{attrs:{flat:""}},[a("thead",[a("tr",{staticClass:"text-left"},[a("th",[t._v("Name")]),a("th",[t._v("# Input fields")]),a("th",[t._v("# Output fields")]),a("th")])]),a("tbody",t._l(t.filteredActions,(function(e){return a("tr",[a("td",[t._v(t._s(e.action_schema.Label)+" on "+t._s(e.action_schema.OnType))]),a("td",[t._v(t._s(e.action_schema.InFields?e.action_schema.InFields.length:0))]),a("td",[t._v(t._s(e.action_schema.OutFields?e.action_schema.OutFields.length:0))]),a("td",{staticClass:"text-right"},[a("q-btn",{staticClass:"float-right",attrs:{size:"sm",label:"Edit action"},on:{click:function(a){return t.showEditAction(e)}}})],1)])})),0)])],1)]),a("q-page-sticky",{staticStyle:{"z-index":"3000"},attrs:{position:"bottom-right",offset:[20,20]}},[a("q-btn",{attrs:{fab:"",icon:"add",color:"primary"},on:{click:function(e){return t.showCreateAction()}}})],1),a("q-drawer",{attrs:{overlay:"","content-class":"bg-grey-3",width:400,side:"right"},model:{value:t.showCreateActionDrawer,callback:function(e){t.showCreateActionDrawer=e},expression:"showCreateActionDrawer"}},[a("q-scroll-area",{staticClass:"fit row"},[a("div",{staticClass:"q-pa-md"},[a("span",{staticClass:"text-h6"},[t._v("Create action")]),a("q-form",{staticClass:"q-gutter-md"},[a("textarea",{attrs:{id:"actionSchemaEditor"}}),a("q-btn",{staticClass:"float-right",attrs:{color:"primary"},on:{click:function(e){return t.createAction()}}},[t._v("Create")]),a("q-btn",{on:{click:function(e){t.showCreateActionDrawer=!1}}},[t._v("Cancel")])],1)],1)])],1),a("q-drawer",{attrs:{overlay:"","content-class":"bg-grey-3",width:400,side:"right"},model:{value:t.showEditActionDrawer,callback:function(e){t.showEditActionDrawer=e},expression:"showEditActionDrawer"}},[a("q-scroll-area",{staticClass:"fit row"},[a("div",{staticClass:"q-pa-md"},[a("span",{staticClass:"text-h6"},[t._v("Edit action")]),a("q-form",{staticClass:"q-gutter-md"},[a("q-btn",{attrs:{color:"negative"},on:{click:function(e){return t.deleteAction()}}},[t._v("Delete")]),a("q-btn",{staticClass:"float-right",on:{click:function(e){t.showEditActionDrawer=!1}}},[t._v("Cancel")])],1)],1)])],1)],1)},i=[],o=(a("8e6e"),a("8a81"),a("ac6a"),a("cadf"),a("06db"),a("456d"),a("7f7f"),a("c47a")),c=a.n(o),s=a("2f62"),r=(a("b116"),a("ebfb")),l=a.n(r);function d(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function h(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?d(Object(a),!0).forEach((function(e){c()(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var f=a("651e"),u={name:"ActionPage",methods:h(h({showCreateAction:function(){var t=this;t.showCreateActionDrawer=!0,setTimeout((function(){t.actionSchemaEditor&&t.actionSchemaEditor.toTextArea&&t.actionSchemaEditor.toTextArea(),t.actionSchemaEditor=new l.a({element:document.getElementById("actionSchemaEditor"),toolbar:[]}),t.actionSchemaEditor.value("---\nName: my_new_action\nLabel: New Action Button Label\nOnType: user_account\nInstanceOptional: false\nInFields:\nOutFields:")}),400)},showEditAction:function(t){this.selectedAction=t,this.showEditActionDrawer=!0,this.newAction.name=t.name,this.newAction.root_path=t.root_path},deleteAction:function(){var t=this;console.log("Delete action",this.selectedAction),this.deleteRow({tableName:"action",reference_id:this.selectedAction.id}).then((function(e){t.showEditActionDrawer=!1,t.selectedAction={},t.$q.notify({title:"Success",message:"Action deleted"}),t.refresh()})).catch((function(e){t.$q.notify({title:"Failed",message:JSON.stringify(e)})}))},editAction:function(){var t=this;console.log("Delete action",this.selectedAction),this.newAction.tableName="action",this.newAction.id=this.selectedAction.id,this.updateRow(this.newAction).then((function(e){t.showEditActionDrawer=!1,t.selectedAction={},t.$q.notify({title:"Success",message:"Action updated"}),t.refresh()})).catch((function(e){t.$q.notify({title:"Failed",message:JSON.stringify(e)})}))},createAction:function(){var t=this;console.log("new action",this.newAction);var e=t.actionSchemaEditor.value(),a={};try{if(a=f.load(e),!a)return void t.$q.notify({message:"Invalid spec, not valid YAML"})}catch(n){return void t.$q.notify({message:"Invalid spec, not valid YAML"})}this.newAction.action_name=a.Name,this.newAction.on_type=t.tables.filter((function(t){return t.table_name===a.OnType}))[0],this.newAction.label=a.Name+" on "+this.newAction.on_type.table_name,this.newAction.action_schema=JSON.stringify(a),this.newAction.tableName="action",this.newAction.world_id={type:"world",id:this.newAction.on_type.id},console.log("New action",this.newAction),t.createRow(t.newAction).then((function(e){t.user={},t.$q.notify({message:"action action created"}),t.refresh(),t.showCreateActionDrawer=!1})).catch((function(e){e instanceof Array?t.$q.notify({message:e[0].title}):t.$q.notify({message:"Failed to create action"})}))}},Object(s["b"])(["loadData","getTableSchema","createRow","deleteRow","updateRow","executeAction"])),{},{refresh:function(){var t="action",e=this;this.loadData({tableName:t,params:{page:{size:500}}}).then((function(t){console.log("Loaded data",t);var a=t.data.map((function(t){try{t.action_schema=JSON.parse(t.action_schema)}catch(t){t.action_schema={InFields:[],OutFields:[],Name:t.action_name,Label:t.action_name}}return t}));a.sort((function(t,e){return t.action_name<e.action_name})),e.actions=a})),this.loadData({tableName:"world",params:{page:{size:500}}}).then((function(t){console.log("Loaded tables data",t);var a=t.data.filter((function(t){return-1===t.table_name.indexOf("_has_")}));a=a.sort((function(t,e){return t.table_name>e.table_name})),e.tables=a}))}}),data:function(){return h({text:"",tables:[],actionSchemaEditor:null,actionFilter:null,selectedAction:{},actionProviderOptions:[{icon:"fas fa-aws",label:"Amazon Drive",description:"OAuth token based"},{icon:"fas fa-aws",label:"Amazon S3",description:"OAuth token based"},{icon:"fas fa-aws",label:"Backblaze B2",description:"OAuth token based"},{icon:"fas fa-aws",label:"Dropbox",description:"OAuth token based"},{icon:"fas fa-aws",label:"FTP",description:"OAuth token based"},{icon:"fas fa-aws",label:"Google Drive",description:"OAuth token based"},{icon:"fas fa-aws",label:"local",description:"The local filesystem"}],showHelp:!1,newAction:{action_name:null,label:null,action_schema:"",world_id:null,instance_optional:!1},showCreateActionDrawer:!1,showEditActionDrawer:!1,filter:null,actions:[],columns:[{name:"name",field:"name",label:"action name",align:"left",sortable:!0}]},Object(s["d"])([]))},mounted:function(){this.refresh()},computed:h(h({filteredActions:function(){var t=this;return t.actions.filter((function(e){return!t.actionFilter||e.action_name.indexOf(t.actionFilter)>-1||e.action_schema.OnType.indexOf(t.actionFilter)>-1||e.action_schema.Label.indexOf(t.actionFilter)>-1}))}},Object(s["c"])([])),Object(s["d"])([])),watch:{}},m=u,b=a("2877"),w=a("ead5"),p=a("0016"),A=a("079e"),_=a("eb85"),g=a("27f9"),v=a("2bb1"),y=a("9c40"),O=a("de5e"),q=a("9404"),C=a("4983"),D=a("0378"),E=a("ddd8"),k=a("eebe"),S=a.n(k),F=Object(b["a"])(m,n,i,!1,null,null,null);e["default"]=F.exports;S()(F,"components",{QBreadcrumbs:w["a"],QIcon:p["a"],QBreadcrumbsEl:A["a"],QSeparator:_["a"],QInput:g["a"],QMarkupTable:v["a"],QBtn:y["a"],QPageSticky:O["a"],QDrawer:q["a"],QScrollArea:C["a"],QForm:D["a"],QSelect:E["a"]})}}]);