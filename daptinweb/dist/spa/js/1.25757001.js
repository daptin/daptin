(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{10:function(e,t){},11:function(e,t){},12:function(e,t){},13:function(e,t){},14:function(e,t){},2:function(e,t){},3:function(e,t){},4:function(e,t){},5:function(e,t){},6:function(e,t){},7:function(e,t){},"713b":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-layout",{attrs:{view:"lHh Lpr lFf"}},[e.isAdmin?a("q-drawer",{attrs:{mini:!e.showAdminDrawerStick&&e.showAdminDrawerMini,"mini-width":50,width:250,breakpoint:1400,"content-class":"",elevated:""},on:{mouseover:function(t){e.showAdminDrawerMini=!1},mouseout:function(t){e.showAdminDrawerMini=!0}},model:{value:e.showAdminDrawer,callback:function(t){e.showAdminDrawer=t},expression:"showAdminDrawer"}},[a("q-scroll-area",{staticClass:"fit"},[a("q-list",{staticClass:"bg-black"},[a("q-item",{attrs:{clickable:""}},[a("q-item-section",{staticClass:"text-white",staticStyle:{"text-transform":"capitalize","font-weight":"bold","font-size":"22px","text-align":"center"},on:{click:function(t){return e.$router.push("/")}}},[e._v("\n              DASHBOARD\n            ")]),a("q-item-section",{attrs:{avatar:""}},[a("q-btn",{attrs:{flat:"",size:"xs",color:"white",icon:"menu"},on:{click:function(t){e.showAdminDrawerStick=!e.showAdminDrawerStick}}})],1)],1)],1),a("q-list",[a("q-expansion-item",{attrs:{"expand-separator":"",label:"Database",value:!0,"expand-icon-class":"text-white",icon:"fas fa-database"}},[a("q-list",[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{"inset-level":1,clickable:""},on:{click:function(t){return e.$router.push("/tables")}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"fas fa-table"}})],1),a("q-item-section",[a("q-item-label",[e._v("\n                    Tables\n                  ")])],1)],1)],1)],1),a("q-expansion-item",{attrs:{"expand-icon-class":"text-white",value:!0,"expand-separator":"",icon:"fas fa-archive",label:"Storage"}},[a("q-list",[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{"inset-level":1,clickable:""},on:{click:function(t){return e.$router.push("/cloudstore")}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"fas fa-bars"}})],1),a("q-item-section",[a("q-item-label",[e._v("\n                    Cloud stores\n                  ")])],1)],1),a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{"inset-level":1,clickable:""},on:{click:function(t){return e.$router.push("/cloudstore/sites")}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"fas fa-desktop"}})],1),a("q-item-section",[a("q-item-label",[e._v("\n                    Sites\n                  ")])],1)],1)],1)],1),a("q-expansion-item",{attrs:{"expand-icon-class":"text-white",value:!0,"expand-separator":"",icon:"fas fa-bolt",label:"Integrations"}},[a("q-list",[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{"inset-level":1,clickable:""},on:{click:function(t){return e.$router.push("/integrations/spec")}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"fas fa-plug"}})],1),a("q-item-section",[a("q-item-label",[e._v("\n                    API Catalogue\n                  ")])],1)],1),a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{"inset-level":1,clickable:""},on:{click:function(t){return e.$router.push("/integrations/actions")}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"fas fa-wrench"}})],1),a("q-item-section",[a("q-item-label",[e._v("\n                    Actions\n                  ")])],1)],1)],1)],1),a("q-expansion-item",{attrs:{"expand-icon-class":"text-white",value:!0,"expand-separator":"",icon:"fas fa-user",label:"Users"}},[a("q-list",[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{"inset-level":1,clickable:""},on:{click:function(t){return e.$router.push("/user/profile")}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"fas fa-id-card"}})],1),a("q-item-section",[a("q-item-label",[e._v("\n                    Profile\n                  ")])],1)],1),a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{"inset-level":1,clickable:""},on:{click:function(t){return e.$router.push("/users")}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"fas fa-address-book"}})],1),a("q-item-section",[a("q-item-label",[e._v("\n                    Accounts\n                  ")])],1)],1),a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{"inset-level":1,clickable:""},on:{click:function(t){return e.$router.push("/groups")}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"fas fa-users"}})],1),a("q-item-section",[a("q-item-label",[e._v("\n                    Groups\n                  ")])],1)],1)],1)],1),a("q-expansion-item",{attrs:{"expand-icon-class":"text-white",value:!0,"expand-separator":"",icon:"fas fa-book",label:"Documentation"}},[a("q-list",[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{"inset-level":1,clickable:""},on:{click:function(t){return e.$router.push("/tables/apidocs")}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"fas fa-book"}})],1),a("q-item-section",[a("q-item-label",[e._v("\n                    JSON API docs\n                  ")])],1)],1),a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{"inset-level":1,clickable:""},on:{click:function(t){return e.$router.push("/tables/graphql")}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"fas fa-book"}})],1),a("q-item-section",[a("q-item-label",[e._v("\n                    GraphQL docs\n                  ")])],1)],1)],1)],1)],1),a("q-list",[a("q-item",{attrs:{clickable:""},on:{click:function(t){return e.logout()}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{color:"negative",name:"fas fa-power-off"}})],1),a("q-item-section",[a("q-item-label",[e._v("\n                Logout\n              ")])],1)],1)],1)],1)],1):e._e(),e.isUser?a("q-page-sticky",{attrs:{position:"bottom-right",offset:[50,50]}},[a("q-btn",{attrs:{fab:"",icon:"menu",color:"primary"},on:{click:function(t){e.userDrawer=!e.userDrawer}}})],1):e._e(),e.isUser&&e.userDrawer?a("q-drawer",{attrs:{"content-class":"bg-grey-3",overlay:"",width:300,breakpoint:100,"show-if-above":"",side:"right"}},[a("q-scroll-area",{staticClass:"fit"},[a("q-list",[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{"inset-level":1,clickable:""},on:{click:e.logout}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"fas fa-lock"}})],1),a("q-item-section",[a("q-item-label",[e._v("\n                Logout\n              ")])],1)],1)],1),a("q-list",[a("q-item",[a("q-item-section",[a("q-btn",{attrs:{label:"Close"},on:{click:function(t){e.userDrawer=!1}}})],1)],1)],1)],1)],1):e._e(),a("q-page-container",[e.isAdmin||e.isUser?a("router-view"):e._e(),e.isAdmin||e.isUser&&!e.showHelp?a("q-page-sticky",{attrs:{position:"top-right",offset:[0,0]}},[a("q-btn",{attrs:{flat:"",fab:"",icon:"fas fa-question"},on:{click:function(t){e.showHelp=!0}}})],1):e._e(),a("q-drawer",{attrs:{width:e.fileDrawerWidth>800?800:e.fileDrawerWidth,overlay:"",breakpoint:400,side:"right"},model:{value:e.showHelp,callback:function(t){e.showHelp=t},expression:"showHelp"}},[e.showHelp?a("q-scroll-area",{staticClass:"fit"},[a("help-page",{on:{closeHelp:function(t){e.showHelp=!1}}})],1):e._e()],1)],1)],1)},n=[],o=(a("8e6e"),a("8a81"),a("ac6a"),a("cadf"),a("06db"),a("456d"),a("a34a")),r=a.n(o),s=(a("96cf"),a("c973")),c=a.n(s),l=a("9523"),u=a.n(l),m=a("2f62");function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){u()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}a("14b7");var f={name:"MainLayout",computed:{fileDrawerWidth:function(){return window.screen.availWidth}},components:{},data:function(){return d(d({showHelp:!1,showAdminDrawer:!1,showAdminDrawerMini:!1,showAdminDrawerStick:!1},Object(m["c"])(["loggedIn","drawerLeft","authToken","decodedAuthToken"])),{},{essentialLinks:[],drawer:!1,userDrawer:!1,loaded:!1,miniState:!0,isAdmin:!1,isUser:!1})},mounted:function(){var e=this;if(console.log("Mounted main layout"),e.decodedAuthToken()){var t=e.decodedAuthToken(),a=1e3*t.exp<(new Date).getTime();console.log("Decoded auth token",a,t),a&&(e.$q.notify({message:"Authentication has expired, please login again"}),e.setDecodedAuthToken(null),e.logout())}e.loadModel(["cloud_store","user_account","usergroup","world","action","site","integration"]).then(c()(r.a.mark((function t(){return r.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.loaded=!0,e.getDefaultCloudStore(),e.loadData({tableName:"user_account"}).then((function(t){var a=t.data;console.log("Users: ",a),2==a.length?(e.isAdmin=!0,e.showAdminDrawer=!0,e.executeAction({tableName:"world",actionName:"become_an_administrator"}).then((function(t){e.$q.notify({message:"You have become the administrator of this instance"})})).catch((function(e){console.log("Failed to become admin",e)}))):a.length>2?(e.isAdmin=!0,e.showAdminDrawer=!0,e.isUser=!1):(e.isUser=!0,e.$router.push("/user/profile"))}));case 3:case"end":return t.stop()}}),t)})))).catch((function(t){console.log("Failed to load model for cloud store",t),e.$q.notify({message:"Failed to load model for cloud store"})}))},methods:d(d({},Object(m["b"])(["getDefaultCloudStore","loadModel","executeAction","loadData","setDecodedAuthToken"])),{},{logout:function(){localStorage.removeItem("token"),localStorage.removeItem("user"),this.$router.push("/login"),window.location=window.location}})},w=f,q=a("2877"),b=a("4d5a"),h=a("9404"),v=a("4983"),k=a("1c1c"),g=a("66e5"),D=a("4074"),A=a("9c40"),x=a("3b73"),y=a("0016"),_=a("0170"),O=a("de5e"),S=a("09e3"),$=a("714f"),N=a("eebe"),j=a.n(N),P=Object(q["a"])(w,i,n,!1,null,null,null);t["default"]=P.exports;j()(P,"components",{QLayout:b["a"],QDrawer:h["a"],QScrollArea:v["a"],QList:k["a"],QItem:g["a"],QItemSection:D["a"],QBtn:A["a"],QExpansionItem:x["a"],QIcon:y["a"],QItemLabel:_["a"],QPageSticky:O["a"],QPageContainer:S["a"]}),j()(P,"directives",{Ripple:$["a"]})},8:function(e,t){},9:function(e,t){}}]);